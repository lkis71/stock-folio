# 매매일지 캘린더 화면 설계서

## 1. 화면 개요

### 1.1 화면 목적
- 월별 매매 활동을 한눈에 파악
- 특정 날짜의 매매 기록 빠른 접근
- 손익 패턴 시각적 확인

### 1.2 접근 경로
- 매매일지 탭 → 캘린더/리스트 세그먼트 전환
- 또는 별도 탭으로 제공 (추후 결정)

## 2. 화면 레이아웃

### 2.1 전체 구조 (ASCII)
```
┌─────────────────────────────────────┐
│ ◀ 2025년 1월           ▶  [리스트] │ ← 헤더
├─────────────────────────────────────┤
│ 월 총 손익: +123,456원 | 거래: 15건 │ ← 월별 통계 (접기 가능)
├─────────────────────────────────────┤
│  일  월  화  수  목  금  토        │ ← 요일 행
├─────────────────────────────────────┤
│          1   2   3   4              │
│      [$] [%] [%] [$]                │ ← 날짜 + 손익 인디케이터
│                                     │
│  5   6   7   8   9   10  11        │
│ [$] [%] [%] [$] [%] [$] [%]        │
│                                     │
│  12  13  14  15  16  17  18        │
│ [$] [%] [%] [$] [%] [$] [%]        │
│                                     │
│  19  20  21  22  23  24  25        │
│ [%] [$] [%] [$] [%] [$] [%]        │
│                                     │
│  26  27  28  29  30  31            │
│ [$] [%] [%] [$] [%] [$]            │
└─────────────────────────────────────┘

[$] = 수익 (파란색 인디케이터)
[%] = 손실 (빨간색 인디케이터)
```

### 2.2 날짜 셀 상세 (확대)
```
┌─────────┐
│   15    │ ← 날짜 (14pt, semibold)
│  ●●●    │ ← 거래 건수 인디케이터 (3개 = 3건)
│ +12.3K  │ ← 손익 금액 (12pt, caption)
│ +4.5%   │ ← 수익률 (11pt, caption2)
└─────────┘
 ↑ 파란색 테두리 (수익)
```

## 3. UI 컴포넌트 상세

### 3.1 헤더 영역

#### 3.1.1 월 선택 컨트롤

**구성 요소**:
- 이전 달 버튼 (왼쪽 화살표 아이콘)
- 월 제목 (중앙, "2025년 1월" 형식)
- 다음 달 버튼 (오른쪽 화살표 아이콘)

**스타일**:
- 폰트: `.headline` (16pt)
- 패딩: 좌우 16pt, 상하 12pt
- 버튼 탭 영역: 최소 44×44pt
- 아이콘: `chevron.left`, `chevron.right` (SF Symbols)

#### 3.1.2 뷰 전환 버튼

**구성 요소**:
- "리스트" 텍스트 버튼 (헤더 우측 상단)

**스타일**:
- 폰트: `.subheadline`
- 색상: `.accentColor`

### 3.2 월별 통계 카드 (접기 가능)

**구성 요소**:
- 헤더 영역
  - "월 통계" 제목 (좌측)
  - 접기/펼치기 버튼 (우측, 위/아래 화살표 아이콘)
- 통계 내용 (펼쳐진 상태)
  - 총 손익 (금액, 수익/손실 색상)
  - 거래 건수
  - 승률 (백분율)

**스타일**:
- 배경색: `.secondarySystemBackground`
- 패딩: 내부 12pt, 외부 16pt
- 코너 라디우스: 10pt
- 폰트: 제목 `.subheadline`, 값 `.caption`
- 통계 항목 간격: 16pt

### 3.3 캘린더 그리드

#### 3.3.1 요일 헤더

**구성 요소**:
- 7개 컬럼 그리드: 일, 월, 화, 수, 목, 금, 토

**스타일**:
- 폰트: `.caption` (11pt)
- 색상: `.secondary`
- 패딩: 상하 8pt
- 정렬: 가운데
- 간격: 0pt (붙임)

#### 3.3.2 날짜 셀

**구성 요소** (위에서 아래 순서):
1. 날짜 숫자
2. 거래 인디케이터 (원형 점, 최대 3개)
3. 손익 금액
4. 수익률 (1% 이상인 경우만 표시)

**상태별 표시**:
- 오늘 날짜: 배경색 강조, 날짜 굵게
- 현재 월: 기본 색상
- 이전/다음 월: 회색 (`.secondary`)
- 매매 있음: 테두리 표시 (수익/손실 색상)
- 매매 없음: 날짜만 표시

**스타일**:
- 셀 높이: 70pt (고정)
- 날짜 폰트: `.subheadline` (14pt)
- 손익 폰트: `.caption2` (11pt)
- 코너 라디우스: 8pt
- 테두리: 수익(파란색)/손실(빨간색) 2pt, 30% 투명도
- 오늘 배경: `.accentColor` 10% 투명도
- 셀 내부 간격: 2pt
- 긴 숫자 처리: `.minimumScaleFactor(0.7)`

#### 3.3.3 거래 인디케이터
- 원형 점(Circle) 4pt 크기
- 최대 3개까지 표시 (3건 이상은 동일)
- 색상: 수익(파란색) / 손실(빨간색)
- 간격: 2pt

### 3.4 해당일 매매일지 시트

**구성 요소**:
- 네비게이션 바
  - 제목: 날짜 (예: "2025년 1월 15일")
  - 닫기 버튼 (우측 상단)
- 거래 목록 (List)
  - 기존 `TradingRecordRow` 컴포넌트 재사용
  - 각 항목 탭 → 상세 화면 네비게이션

**스타일**:
- 시트 높이: 중간(.medium) 또는 전체(.large) 선택 가능
- 드래그 인디케이터: 표시
- 제목 스타일: `.inline`
- 리스트 항목 패딩: 상하 4pt

## 4. 인터랙션 정의

### 4.1 제스처

#### 4.1.1 스와이프 (선택 사항)
- 좌측 스와이프: 다음 달 이동
- 우측 스와이프: 이전 달 이동
- 애니메이션: 스프링 효과 (0.3초)

#### 4.1.2 탭
- 날짜 셀 탭: 해당일 매매일지 시트 표시
- 통계 카드 탭: 접기/펼치기
- 거래 없는 날짜: 탭 무반응 (시각적 피드백 없음)

### 4.2 애니메이션

| 액션 | 애니메이션 타입 | 지속 시간 |
|------|----------------|-----------|
| **월 전환** | 스프링 (spring) | 0.3초 |
| **통계 카드 접기/펼치기** | 이즈인아웃 (easeInOut) | 0.2초 |
| **시트 표시** | 시스템 기본 | - |

### 4.3 상태 관리

| 상태 변수 | 타입 | 용도 |
|----------|------|------|
| **currentMonth** | DateComponents | 현재 표시 중인 월 |
| **selectedDate** | Date? | 선택된 날짜 |
| **showingDailyTrades** | Bool | 매매일지 시트 표시 여부 |
| **isStatExpanded** | Bool | 통계 카드 펼침 상태 |

## 5. 스타일 가이드

### 5.1 색상

| 요소 | 색상 | 용도 |
|------|------|------|
| 수익 | `.blue` | 수익 금액, 테두리, 인디케이터 |
| 손실 | `.red` | 손실 금액, 테두리, 인디케이터 |
| 오늘 배경 | `.accentColor (10%)` | 오늘 날짜 강조 |
| 통계 카드 배경 | `.secondarySystemBackground` | 통계 카드 |
| 이전/다음 달 날짜 | `.secondary` | 비활성 날짜 |

### 5.2 타이포그래피

| 요소 | 폰트 | 크기 | 굵기 |
|------|------|------|------|
| 월 제목 | `.headline` | 16pt | semibold |
| 날짜 | `.subheadline` | 14pt | regular (오늘: bold) |
| 손익 금액 | `.caption2` | 11pt | regular |
| 수익률 | `.caption2` | 11pt | regular |
| 통계 제목 | `.subheadline` | 14pt | semibold |
| 통계 값 | `.caption` | 12pt | regular |

### 5.3 스페이싱

| 요소 | 값 |
|------|------|
| 헤더 패딩 (좌우) | 16pt |
| 헤더 패딩 (상하) | 12pt |
| 통계 카드 패딩 (내부) | 12pt |
| 통계 카드 패딩 (외부) | 16pt |
| 날짜 셀 간격 | 0pt (붙임) |
| 셀 내부 요소 간격 | 2pt |
| 인디케이터 간격 | 2pt |

### 5.4 크기

| 요소 | 값 |
|------|------|
| 날짜 셀 높이 | 70pt |
| 인디케이터 원 크기 | 4pt |
| 코너 라디우스 (셀) | 8pt |
| 코너 라디우스 (통계 카드) | 10pt |
| 테두리 두께 | 2pt |

## 6. 다크 모드 대응

### 6.1 색상 조정
- 수익/손실 색상은 다크 모드에서도 동일 유지
- 배경색: 시스템 자동 대응 (`.secondarySystemBackground`)
- 텍스트: 시스템 자동 대응 (`.primary`, `.secondary`)

### 6.2 시각적 대비
- 테두리 투명도 조정: 라이트(30%) / 다크(40%)
- 오늘 배경 투명도: 일관되게 10% 유지

## 7. 접근성

### 7.1 VoiceOver

| 요소 | 읽기 내용 | 힌트 |
|------|----------|------|
| **날짜 셀** | "{날짜}일, {거래 건수}건 거래, {손익 금액}" | "탭하여 상세 보기" |
| **월 이동 버튼** | "이전 달" / "다음 달" | "{월}로 이동" |
| **통계 카드** | "월 통계, 총 손익 {금액}, 거래 {건수}건, 승률 {백분율}" | "탭하여 접기/펼치기" |

### 7.2 Dynamic Type
- 모든 폰트는 Dynamic Type 지원
- `.minimumScaleFactor(0.7)` 적용으로 레이아웃 유지

### 7.3 색상 대비
- WCAG AA 기준 충족
- 색맹 모드 대응 (테두리 + 텍스트 조합)

## 8. 반응형 대응

### 8.1 가로 모드
- 날짜 셀 크기 자동 조정 (`.flexible()`)
- 통계 카드는 가로로 확장
- 시트는 `.large` 크기로 표시

### 8.2 작은 화면 (SE 시리즈)
- 셀 높이: 60pt로 축소
- 폰트 크기: `.minimumScaleFactor(0.6)` 적용
- 수익률 표시 생략 가능

## 9. 성능 최적화

### 9.1 데이터 로딩
- 월별 데이터만 쿼리 (당월 ±1개월)
- 캐싱 적용 (동일 월 재방문 시 캐시 사용)

### 9.2 렌더링
- `LazyVGrid` 사용으로 지연 렌더링
- 날짜 셀 재사용 최적화

### 9.3 애니메이션
- `.spring(duration: 0.3)` 사용으로 부드러운 전환
- 과도한 애니메이션 지양

## 10. 화면 플로우

```
TradingJournalView
  │
  ├─ [리스트 모드] ─────────────┐
  │   └─ TradingRecordRow       │
  │        └─ Detail View        │
  │                              │
  └─ [캘린더 모드] ──────────────┤
      ├─ 월 선택 (◀ ▶)          │
      ├─ 통계 카드 (접기 가능)   │
      └─ 날짜 셀 탭              │
           └─ DailyTradesSheet ──┘
                └─ TradingRecordRow
                     └─ Detail View
```
