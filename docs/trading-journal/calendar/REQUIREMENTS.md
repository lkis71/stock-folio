# 매매일지 캘린더 기능 요구사항 정의서

## 문서 정보

**버전:** v1.0
**최종 수정일:** 2024-12-24
**작성자:** Claude Code

## 변경 이력

### v1.0 (2024-12-24)
- 초기 작성
- 필수 기능(P0) 및 선택 기능(P1) 정의
- 데이터 모델 및 조회 정책 수립
- Phase별 구현 계획 및 성공 지표 설정

## 1. 기능 개요

| 항목 | 내용 |
|------|------|
| **목적** | 매매일지를 캘린더 형태로 시각화하여 월별 매매 패턴 파악 |
| **주요 가치** | 특정 날짜의 매매 활동 빠른 조회, 수익/손실 추세 직관적 확인 |
| **제공 범위** | 월 단위 캘린더 뷰, 일별 매매 요약, 상세 매매일지 연동 |

## 2. 기능 요구사항

### 2.1 필수 기능 (P0)

| 기능 ID | 기능명 | 상세 설명 | 우선순위 |
|---------|--------|-----------|----------|
| **CAL-001** | 캘린더 표시 | 월별 캘린더 그리드 표시 (7일 × 주 수) | P0 |
| | | 이전/다음 달 이동 기능 | |
| | | 오늘 날짜 강조 표시 | |
| | | 매매가 있는 날짜 시각적 구분 | |
| **CAL-002** | 일별 매매 요약 | 날짜 셀에 매매 건수 표시 (인디케이터) | P0 |
| | | 일일 손익 금액 표시 | |
| | | 손익 상태 색상 구분 (수익/손실) | |
| **CAL-003** | 날짜 선택 및 상세 조회 | 특정 날짜 탭 → 해당일 매매일지 목록 시트 표시 | P0 |
| | | 매매일지 상세 화면으로 네비게이션 | |
| | | 매매 없는 날짜 선택 불가 처리 | |

### 2.2 선택 기능 (P1)

| 기능 ID | 기능명 | 상세 설명 | 우선순위 |
|---------|--------|-----------|----------|
| **CAL-004** | 월별 통계 | 월 전체 손익 합계 표시 | P1 |
| | | 월 총 매매 건수 표시 | |
| | | 승률 (수익 거래 / 전체 거래) 표시 | |
| **CAL-005** | 필터링 | 특정 종목만 캘린더에 표시 | P1 |
| | | 포트폴리오별 필터링 | |
| | | 수익/손실만 표시 | |
| **CAL-006** | 뷰 모드 전환 | 캘린더 뷰 ↔ 리스트 뷰 전환 | P1 |
| | | 주간 뷰 지원 (선택 사항) | P2 |

### 2.3 비기능 요구사항

| 카테고리 | 요구사항 | 목표 값 |
|----------|----------|---------|
| **성능** | 월별 데이터 로드 시간 | 1초 이내 |
| | 월 이동 애니메이션 | 부드러운 전환 (0.3초) |
| | 대량 거래 처리 | 월 100건 이상 지원 |
| **접근성** | VoiceOver 지원 | 날짜 및 손익 정보 읽기 |
| | Dynamic Type 지원 | 모든 텍스트 요소 |
| | 다크 모드 대응 | 전체 화면 |
| **사용성** | 디자인 원칙 | 컴팩트 디자인 준수 |
| | 조작 방식 | 한 손 조작 가능 |
| | 제스처 | 직관적 (스와이프 월 이동) |

## 3. 데이터 요구사항

### 3.1 데이터 모델

| 모델명 | 속성 | 타입 | 설명 |
|--------|------|------|------|
| **DailyTradingSummary** | date | Date | 날짜 |
| | tradeCount | Int | 매매 건수 |
| | totalProfit | Decimal | 일일 총 손익 |
| | profitRate | Decimal | 일일 수익률 |
| | trades | [TradingRecord] | 해당일 거래 목록 |
| **MonthlyStatistics** | month | DateComponents | 연/월 |
| | totalProfit | Decimal | 월 총 손익 |
| | totalTradeCount | Int | 월 총 거래 건수 |
| | winRate | Decimal | 승률 |
| | dailySummaries | [DailyTradingSummary] | 일별 요약 목록 |

### 3.2 데이터 조회 정책

| 항목 | 정책 |
|------|------|
| **조회 방식** | SwiftData 날짜 범위 기반 쿼리 |
| **집계 대상** | TradingRecord 모델 |
| **성능 최적화** | 월별 캐싱 적용 |

## 4. 제약사항

### 4.1 기술적 제약

| 항목 | 제약 내용 |
|------|-----------|
| **플랫폼** | iOS 17.0 이상 |
| **데이터 계층** | SwiftData |
| **UI 프레임워크** | SwiftUI |

### 4.2 디자인 제약

| 항목 | 제약 내용 |
|------|-----------|
| **디자인 원칙** | 컴팩트 디자인 준수 |
| **날짜 셀 크기** | 최소 44pt (터치 영역 보장) |
| **캘린더 높이** | 화면의 50% 이하 |

### 4.3 데이터 제약

| 항목 | 제약 내용 |
|------|-----------|
| **필수 데이터** | 매매일지 데이터 존재 필수 |
| **조회 범위** | 과거 데이터 무제한 조회 가능 |
| **미래 날짜** | 선택 불가 |

## 5. 개발 우선순위

### 5.1 Phase별 구현 계획

| Phase | 기능 ID | 기능명 | 우선순위 | 비고 |
|-------|---------|--------|----------|------|
| **Phase 1 (MVP)** | CAL-001 | 월별 캘린더 표시 | P0 | 필수 |
| | CAL-002 | 일별 매매 건수/손익 표시 | P0 | 필수 |
| | CAL-003 | 날짜 탭 → 해당일 매매일지 조회 | P0 | 필수 |
| | CAL-001 | 이전/다음 달 이동 | P0 | 필수 |
| **Phase 2** | CAL-004 | 월별 통계 표시 | P1 | 승률 포함 |
| | CAL-006 | 캘린더 ↔ 리스트 뷰 전환 | P1 | |
| | CAL-005 | 종목 필터링 | P1 | |
| **Phase 3** | CAL-006 | 주간 뷰 | P2 | 선택 사항 |
| | - | 승률 시각화 | P2 | 차트 형태 |
| | - | 차트 연동 (손익 추이) | P2 | 선택 사항 |

## 6. 기존 기능과의 통합

### 6.1 연관 기능

| 연관 기능 | 관계 | 통합 방식 |
|-----------|------|-----------|
| **매매일지 리스트 뷰** | 동등 | 캘린더 뷰: 월별 개요, 리스트 뷰: 상세 조회/편집 |
| | | 탭 또는 세그먼트로 뷰 전환 |
| **TradingRecord 모델** | 데이터 공유 | 동일한 모델 사용 |
| **TradingJournalViewModel** | 로직 공유 | ViewModel 확장 또는 별도 ViewModel |

### 6.2 화면 전환 흐름

```
TradingJournalView (탭바)
  ├─ 리스트 모드 (기본)
  └─ 캘린더 모드 (신규)
       └─ 날짜 선택
            └─ DailyTradesSheet (해당일 거래 목록)
                 └─ TradingJournalDetailView (거래 상세)
```

## 7. 성공 지표

| 지표명 | 목표 값 | 측정 방법 |
|--------|---------|-----------|
| **캘린더 뷰 사용률** | 30% 이상 | 전체 사용자 대비 캘린더 뷰 사용자 비율 |
| **날짜별 조회 시간** | 2초 이내 | 날짜 선택 → 시트 표시까지 소요 시간 |
| **월 이동 성공률** | 95% 이상 | 월 이동 시도 대비 성공 비율 |
| **사용자 만족도** | 4.0/5.0 이상 | 설문 조사 또는 앱 리뷰 |
